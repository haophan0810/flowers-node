extends includes/layout.pug


mixin product(item)
    - const nameProductSlug = item.productNameSlug
    - const nameProduct = item.productName
    - const idProduct = item.id
    - const imageSrc = item.ProductImages[0].imageSrc
    - const nameImageProduct = item.ProductImages[0].imageName
    - const lengthProductDiscount = item.ProductDiscounts.length
    - const isActiveProductDiscount = lengthProductDiscount ? item.ProductDiscounts[0].isActive : false
    - const discountUnit = lengthProductDiscount ? item.ProductDiscounts[0].discountUnit : 0
    - const costBase = item.ProductPricings[0].basePrice
    - const discountValue = lengthProductDiscount ? item.ProductDiscounts[0].discountValue : 0
    - let costDiscount = discountValue ? costBase - (discountValue*costBase)/100 : 0

    - costDiscount = Math.round(costDiscount)

    
    .col-sm-12.col-md-6.col-lg-3.mb-5.d-flex.align-items-stretch       
        .card
            .card-img-top.product__relative
                a.card-link(href=`/product/${nameProductSlug}.${idProduct}.${idCategory}.html`)
                    img.productImg(src='https://res.cloudinary.com/haophan/image/upload/v1547547257/LL19.jpg', alt=item.ProductImages.imageName)
                    if lengthProductDiscount>0 && isActiveProductDiscount
                        .lable-promotion
                            .btn.btn-danger.btn--sale -#{discountUnit}
            .card-body
                a.card-link(href=`/product/${nameProductSlug}.${idProduct}.${idCategory}.html`)
                    h5.card-title.card--title #{nameProduct}
                p.card-text
                    - for(let i = 0 ; i<item.productStar; i++){
                        i.fas.fa-star.star--color
                    - }
                    - for(let i = item.productStar ; i<5; i++){
                        i.fas.fa-star.star--disable
                    - }
                p.card-text
                    if lengthProductDiscount>0 && isActiveProductDiscount 
                        span.productCostDiscount.mr-2.cost #{costDiscount} $
                        span.productCostBase.productCostBase--line-through #{costBase} $
                    else     
                        span.productCostBase.cost #{costBase} $

mixin comment(user)
  .col-lg-3.p-4
    // Card
    .d-flex.flex-column.text-center.align-items-center
      // Card image
      img.rounded-circle.mb-2(src='https://mdbootstrap.com/img/Photos/Others/images/43.jpg', width='65', height='65' alt='Card image cap')
      // Card content
      .userInfo
        h5.userName hello
        .userAddress
          span đến từ 
          span.address Ho Chi Minh
        .timePost tháng trước
  .col-lg-9.p-4
    .h5.commentTitle Rất tốt
    span.commentContent Lorem ipsum dolor sit amet.

block head
    link(rel='stylesheet', href='../../css/index.css')
    link(rel="stylesheet", href="../../css/productDescription.css")

block nav
  - const lengthProductsAdv = productsAdv.length ? 4 : productsAdv.length
  // Main layout
  main.mt-5.pt-4
    .container.dark-grey-text.mt-5
      // Grid row
      .row.wow.fadeIn
        // Grid column
        .col-md-5.mb-4.p-5
          img.img-fluid(src=product[0].ProductImages[0].imageSrc, alt=product[0].ProductImages[0].imageName)
        // Grid column
        // Grid column
        .col-md-7.mb-4
          // Content
          .p-4
            .mb-3
              a(href='')
                span.badge.purple.mr-1 Category 2
              a(href='')
                span.badge.blue.mr-1 New
              a(href='')
                span.badge.red.mr-1 Bestseller
            p.lead
              span.mr-1
                del $200
              span $100
            p.lead.font-weight-bold #{product[0].productName}
            p.mb-5 #{product[0].productDescription}
            form.d-flex.justify-content-left
              // Default input
              input.form-control(type='number', value='1', aria-label='Search', style='width: 100px', max=product[0].productQuantity)
              button.btn.bgBtnMain.btn-md.my-0.p(type='submit')
                | Add to cart
                i.fas.fa-shopping-cart.ml-1
          // Content
        // Grid column
      // Grid row
      hr
      // Grid row
      .row.d-flex.justify-content-center.wow.fadeIn
        // Grid column
        .col-md-6.text-center
          h2.my-4.h4 Additional information
            .line-break.text-center
              img(src="https://res.cloudinary.com/haophan/image/upload/v1547963844/line.png", width='150' alt="")
          
        // Grid column
      // Grid row
      // Grid row
      .row
        - for (let i = 0; i<lengthProductsAdv; i++){
          +product(productsAdv[i])
        -}
    
      

    section.container.dark-grey-text.mt-5
      h2.m-3.h4 Customers reviews
      .row.mt-5
        .col-lg-7
          .row
            .col-lg-5
              .tex-center
                .h5 Average Review
                p.total-review 4.5/5
                div
                  i.fas.fa-star
                  i.fas.fa-star
                  i.fas.fa-star
                  i.fas.fa-star
                  i.fas.fa-star
                p 10 nguoi danh gia
            .col-lg-7
              .itemRate.d-flex.alignItemCenter
                .ratingNum.mr-3
                  span.numberVote.mr-2 5
                  i.fas.fa-star
                .progress.md-progress.w-75.mr-3
                  .progress-bar(role='progressbar', style='width: 100%', aria-valuenow='100', aria-valuemin='0', aria-valuemax='100')
                .percentVote 50%

              .itemRate.d-flex.alignItemCenter
                .ratingNum.mr-3
                  span.numberVote.mr-2 5
                  i.fas.fa-star
                .progress.md-progress.w-75.mr-3
                  .progress-bar(role='progressbar', style='width: 75%', aria-valuenow='100', aria-valuemin='0', aria-valuemax='100')
                .percentVote 50%

              .itemRate.d-flex.alignItemCenter
                .ratingNum.mr-3
                  span.numberVote.mr-2 5
                  i.fas.fa-star
                .progress.md-progress.w-75.mr-3
                  .progress-bar(role='progressbar', style='width: 100%', aria-valuenow='100', aria-valuemin='0', aria-valuemax='100')
                .percentVote 50%

              .itemRate.d-flex.alignItemCenter
                .ratingNum.mr-3
                  span.numberVote.mr-2 5
                  i.fas.fa-star
                .progress.md-progress.w-75.mr-3
                  .progress-bar(role='progressbar', style='width: 100%', aria-valuenow='100', aria-valuemin='0', aria-valuemax='100')
                .percentVote 50%

              .itemRate.d-flex.alignItemCenter
                .ratingNum.mr-3
                  span.numberVote.mr-2 5
                  i.fas.fa-star
                .progress.md-progress.w-75.mr-3
                  .progress-bar(role='progressbar', style='width: 100%', aria-valuenow='100', aria-valuemin='0', aria-valuemax='100')
                .percentVote 50%




        .col-lg-5
          .reviewsNoLogin(class= userLogin ? 'displayNone' : '')
            span.pl-5 Login to review product
            a(href='/login').ml-2.btn.bgBtnMain login
          .reviewLogged.d-flex.justify-content-end(class= userLogin ? '' : 'displayNone')
            form.text-center.w-75
              .h4.text-center Send Review
              .voteReview.d-flex
                span.mr-3 vote
                p
                  i.fas.fa-star.popovers
                  i.fas.fa-star.popovers
                  i.fas.fa-star.popovers
                  i.fas.fa-star.popovers
                  i.fas.fa-star.popovers
              lable.d-flex(for='commentTitle') Title
              input#commentTitle.form-control.mb-4(type='text'
                placeholder='Title review'
                name='commentTitle')
              
              .form-group
                lable.d-flex(for='commentContent') Review
                textarea#commentContent.form-control.rounded-0(rows='3'
                placeholder='Review content'
                name='commentContent')
              button.btn.btn-info.btn-block.my-4.bgBtnMain(type='submit') Send Review
      hr
      .row
        - for (let i = 0; i<5; i++){
          +comment(i)
        -}
      nav.container.d-flex.justify-content-end(aria-label='Page navigation example')
        ul.pagination
            li.page-item(class= indexPage<2? 'page-item--hidden': '')
                a.page-link(href=`/products?page=${indexPage-1}`) Previous

            li.page-item
                a.page-link(href=`/products?page=${currentPage-1}`, class= indexPage===1? 'page-item--active' : '') #{currentPage-1}

            li.page-item
                a.page-link(href=`/products?page=${currentPage}`, class= indexPage===1? '' : 'page-item--active') #{currentPage}
                
            li.page-item(class= indexPage>maxPage-1 ? 'page-item--hidden': '')
                a.page-link(href=`/products?page=${currentPage+1}`) #{currentPage+1}
                
            li.page-item(class= indexPage>maxPage-2 ? 'page-item--hidden': '')
                a.page-link(href=`/products?page=${indexPage+1}`) Next  


      
block footer